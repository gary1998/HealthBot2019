<!doctype html>
    <head>
        <meta charset="utf-8">
        <title>HealthBot 2019</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="css/bootstrap.min.css">
        <link rel="stylesheet" href="css/bootstrap-theme.min.css">
        <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
        <style>
            body {
                padding-top: 50px;
                padding-bottom: 20px;
            }
            .fa-google {
                background: #dd4b39;
                color: white;
                border: 4px solid #dd4b39;
            }
            .fa-facebook {
                background: #3B5998;
                color: white;
                border: 4px solid #3B5998;
            }
        </style>
        <script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
    </head>
    <body>
        <div class="modal fade" id="signUpModal" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h2 style="text-align:center;">Sign Up</h2>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="signUpEmail">E-Mail</label>
                            <input class="form-control" placeholder="E-Mail" type="email" id="signUpEmail">
                        </div>
                        <div class="form-group">
                            <label for="signUpPwd">Password</label>
                            <input class="form-control" placeholder="Password" type="password" id="signUpPwd">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <div class="g-recaptcha" data-sitekey="" style="float:left;"></div>
                        <button type="button" id="signUpBtn" class="btn btn-success" onclick="signUp()">Confirm</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="modal fade" id="resetModal" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h2 style="text-align:center;">Reset Password</h2>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="resetEmail">E-Mail</label>
                            <input class="form-control" placeholder="E-Mail" type="email" id="resetEmail">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="resetBtn" class="btn btn-success" onclick="reset()">Send Link</button>
                    </div>
                </div>
            </div>
        </div>
        
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">HealthBot 2019</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <form class="navbar-form navbar-right" role="form" target="return false;">
            <div class="form-group">
                <abbr title="Enter E-Mail"><input id="email" type="text" placeholder="Email" class="form-control"></abbr>
            </div>
            <div class="form-group">
                <abbr title="Enter Password"><input id="pwd" type="password" placeholder="Password" class="form-control"></abbr>
            </div>
                <abbr title="Login with E-Mail & Password"><a href="#" id="mailLoginBtn" class="btn btn-success" onclick="MailSignIn()"><i class="fa fa-sign-in" aria-hidden="true"></i></a></abbr>
                <abbr title="Login with Facebook"><a href="#" id="fbLoginBtn" class="btn fa fa-facebook" onclick="FBSignIn()"></a></abbr>
                <abbr title="Login with Google"><a href="#" id="googleLoginBtn" class="btn fa fa-google" onclick="GSignIn()"></a></abbr>
          </form>
        </div>
      </div>
    </nav>

    <div class="jumbotron">
      <div class="container">
        <h1>Speak Up!</h1>
        <p>Welcome to the first ever web-application which can diagnose almost each and every disease and keep you healthy anytime, everywhere, without hassle and <strong>heavy Doctors' fees</strong>.</p>
        <p>
            <abbr title="Sign up"><a class="btn btn-primary btn-lg" href="#" data-toggle="modal" data-target="#signUpModal" role="button">Sign Up &raquo;</a></abbr>
        </p>
        <p>Trouble logging in? <a href="#" data-toggle="modal" data-target="#resetModal">Reset Password</a></p>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-md-4">
          <h2>Chat & Get Diagnosed</h2>
          <p>Application asks you few very basic questions and on the basis of your answers, it diagnoses you. </p>
          <p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>
        </div>
        <div class="col-md-4">
          <h2>Study Disease</h2>
          <p>You can study about your disease on reputed web-sites and libraries over Internet. </p>
          <p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>
       </div>
        <div class="col-md-4">
          <h2>Monthly Report</h2>
          <p>Application maintains your monthly report, so as to keep your safe in future.</p>
          <p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>
        </div>
      </div>

      <hr>

      <footer>
        <p>&copy; EDGE 2019</p>
      </footer>
    </div>
    <script src="js/vendor/jquery-1.11.2.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.11.2.min.js"><\/script>')</script>
    <script src="js/vendor/bootstrap.min.js"></script>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
    <script src="https://www.gstatic.com/firebasejs/5.9.1/firebase.js"></script>
    <script>
        function reset()
        {
            $('#resetBtn').html('<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>');
            $('#resetBtn').addClass('disabled');
            var email = $('#resetEmail').val();
            if(email)
            {
                firebase.auth().sendPasswordResetEmail(email).then(function() {
                    $('#resetModal').modal("toggle");
                    alert('Password reset link sent!');
                }).catch(function(error) {
                    alert(error.message);
                });
            }
            else
            {
                alert('Enter E-Mail address!');
            }
        }
        function signUp()
        {
            $('#signUpBtn').html('<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>');
            $('#signUpBtn').addClass('disabled');
            var email = $('#signUpEmail').val();
            var pass = $('#signUpPwd').val();
            if(email && pass && grecaptcha.getResponse())
            {
                firebase.auth().createUserWithEmailAndPassword(email, pass).then(function()
                {
                    var user = firebase.auth().currentUser;
                    user.sendEmailVerification().then(function() 
                    {
                        $('#signUpModal').modal("toggle");
                        alert('Verification link sent!');
                        grecaptcha.reset();
                        $('#signUpEmail').val("");
                        $('#signUpPwd').val("");
                        $('#signUpBtn').html('Confirm');
                        $('#signUpBtn').removeClass('disabled');
                    }).catch(function(error) 
                    {
                        alert(error.message);
                        grecaptcha.reset();
                        $('#signUpEmail').val("");
                        $('#signUpPwd').val("");
                        $('#signUpBtn').html('Confirm');
                        $('#signUpBtn').removeClass('disabled');
                    });

                }).catch(function(error) 
                {
                    alert(error.message);
                    grecaptcha.reset();
                    $('#signUpEmail').val("");
                    $('#signUpPwd').val("");
                    $('#signUpBtn').html('Confirm');
                    $('#signUpBtn').removeClass('disabled');
                });
            }
            else
            {
                alert("Something went wrong!");
                grecaptcha.reset();
                $('#signUpEmail').val("");
                $('#signUpPwd').val("");
                $('#signUpBtn').html('Confirm');
                $('#signUpBtn').removeClass('disabled');
            }
        }
        function MailSignIn()
        {
            $('#mailLoginBtn').html('<i class="fa fa-spinner fa-spin" aria-hidden="true"></i>');
            $('#mailLoginBtn').addClass("disabled");
            var email = $('#email').val();
            var password = $('#pwd').val();
            if(email && password)
            {
                firebase.auth().signInWithEmailAndPassword(email, password).then(function()
                {
                    if(firebase.auth().currentUser.emailVerified)
                    {
                        window.location = "user.html";
                    }
                    else
                    {
                        alert("This account isn't verified yet, please verify to continue");
                        $('#mailLoginBtn').html('<i class="fa fa-sign-in" aria-hidden="true"></i>');
                        $('#mailLoginBtn').removeClass("disabled");
                        $('#email').val("");
                        $('#pwd').val("");
                    }
                }).catch(function(error) {
                    alert(error.message);
                    $('#mailLoginBtn').html('<i class="fa fa-sign-in" aria-hidden="true"></i>');
                    $('#mailLoginBtn').removeClass("disabled");
                    $('#email').val("");
                    $('#pwd').val("");
                });
            }
            else
            {
                alert("Enter both details correctly!");
                $('#mailLoginBtn').html('<i class="fa fa-sign-in" aria-hidden="true"></i>');
                $('#mailLoginBtn').removeClass("disabled");
                $('#email').val("");
                $('#pwd').val("");
            }
        }
        function GSignIn()
        {
            $('#googleLoginBtn').html(' <i class="fa fa-spinner fa-spin" aria-hidden="true"></i>');
            $('#googleLoginBtn').addClass("disabled");
            var provider = new firebase.auth.GoogleAuthProvider();
            firebase.auth().signInWithPopup(provider).then(function(result) {
                window.location = "user.html";
            }).catch(function(error) {
                alert(error.message);
                $('#googleLoginBtn').html('');
                $('#googleLoginBtn').removeClass("disabled");
                $('#email').val("");
                $('#pwd').val("");
            });
        }
        function FBSignIn()
        {
            $('#fbLoginBtn').html(' <i class="fa fa-spinner fa-spin" aria-hidden="true"></i>');
            $('#fbLoginBtn').addClass("disabled");
            var provider = new firebase.auth.FacebookAuthProvider();
            firebase.auth().signInWithPopup(provider).then(function(result) {
                window.location = "user.html";
            }).catch(function(error) {
                alert(error.message);
                $('#fbLoginBtn').html('');
                $('#fbLoginBtn').removeClass("disabled");
                $('#email').val("");
                $('#pwd').val("");
            });
        }
        $(document).ready(function()
        {
            $.getJSON("firebase_config.json",function(conf)
            {
                firebase.initializeApp(conf);
            });
            $.getJSON("recaptcha_config.json",function(conf)
            {
                $('.g-recaptcha').attr("data-sitekey",conf);
            });
            $('#pwd').keypress(function(i)
            {
                    if(i.keyCode===13)
                    {
                        MailSignIn();
                    }
            });
            $('#signUpPwd').keypress(function(i)
            {
               if(i.keyCode===13)
               {
                   signUp();
               }
            });
            $('#resetEmail').keypress(function(i)
            {
                if(i.keyCode===13)
                {
                    reset();
                }
            });
        });
    </script>
    </body>
</html>
